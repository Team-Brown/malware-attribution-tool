import os
import gensim
import pprint
from gensim import corpora
from collections import defaultdict

# change directory to where the samples are stored
os.chdir('samples/equationGroup')

# objdump -d ___ output -- need to automate
objdump = open('triple_fantasy.txt', 'r')

# file to write the extracted instructions to
instructions = open("triple_fantasy_instructions.txt", "w+")

def parseInstructions(o,i):
    lines = o.readlines()

    for line in lines:
        if ("..." in line):
            continue

        if(len(line.split('\t')) >= 3):
            command = line.split('\t')[2]
            instruction = command.split(" ")[0]
        else:
            continue

        i.write(instruction + '\n')

    i.close()
    instructions = open("triple_fantasy_instructions.txt", "r")
    i = instructions.read()
    texts = [word for word in i.lower().split("\n")]

    for text in texts:
        if text == " ":
            texts.remove(text)
        elif text == "":
            texts.remove(text)

    return texts

def languageAnalysis(i):
    frequency = defaultdict(int)
    for token in i:
        frequency[token] += 1

    processed_corpus = [token for token in i if frequency[token] > 1]
    print(frequency)
    # pprint.pprint(processed_corpus)
    print("************************\n\n")
    j = [processed_corpus]

    dictionary = corpora.Dictionary(j)
    print(dictionary)

i = parseInstructions(objdump, instructions)

objdump.close()

languageAnalysis(i)
